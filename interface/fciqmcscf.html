

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fciqmcscf — Full configuration interaction quantum Monte Carlo (FCIQMC) &mdash; PySCF 1.7.6 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cornell_shci — Semistochastic heat-bath configuration interaction (SHCI)" href="cornell_shci.html" />
    <link rel="prev" title="dmrgscf — DMRG and DMRG-SCF/CASSCF" href="dmrgscf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">2. Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark.html">4. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">5. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">6. Theoretical methods</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code-rule.html">Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/scf_developer.html">Self-consistent field (SCF) methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/dft_developer.html">Density functional theory (DFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Miscellaneous</a></li>
</ul>
<p class="caption"><span class="caption-text">API documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Main modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../interface.html">Interfaces</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dftd3.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dftd3</span></code> — DFT with D3 dispersion correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="geomopt.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">geomopt</span></code> — Geometry optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmrgscf.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmrgscf</span></code> — DMRG and DMRG-SCF/CASSCF</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fciqmcscf</span></code> — Full configuration interaction quantum Monte Carlo (FCIQMC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscf.fciqmcscf.fciqmc">Program reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cornell_shci.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cornell_shci</span></code> — Semistochastic heat-bath configuration interaction (SHCI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="shciscf.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shciscf</span></code> — Semistochastic heat bath configuration interaction (SHCI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="icmpspt.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">icmpspt</span></code> — Internal-contracted MPS perturbation method</a></li>
<li class="toctree-l2"><a class="reference internal" href="nao.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nao</span></code> — Numerical Atomic Orbitals</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySCF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../interface.html">Interfaces</a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">fciqmcscf</span></code> — Full configuration interaction quantum Monte Carlo (FCIQMC)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/interface/fciqmcscf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fciqmcscf-full-configuration-interaction-quantum-monte-carlo-fciqmc">
<span id="fciqmcscf"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">fciqmcscf</span></code> — Full configuration interaction quantum Monte Carlo (FCIQMC)<a class="headerlink" href="#fciqmcscf-full-configuration-interaction-quantum-monte-carlo-fciqmc" title="Permalink to this headline">¶</a></h1>
<p>An interface to the <a class="reference external" href="https://github.com/ghb24/NECI_STABLE">NECI</a> FCIQMC solver.
To use NECI, you need create a config file
<code class="docutils literal notranslate"><span class="pre">pyscf/fciqmcscf/settings.py</span></code> to store the path where NECI was installed.</p>
<div class="section" id="module-pyscf.fciqmcscf.fciqmc">
<span id="program-reference"></span><h2>Program reference<a class="headerlink" href="#module-pyscf.fciqmcscf.fciqmc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.add_inactive_space_to_rdm">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">add_inactive_space_to_rdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">mo_coeff</span></em>, <em class="sig-param"><span class="n">one_pdm</span></em>, <em class="sig-param"><span class="n">two_pdm</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#add_inactive_space_to_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.add_inactive_space_to_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>If a CASSCF calculation has been done, the final RDMs from neci will
not contain the doubly occupied inactive orbitals. This function will add
them and return the full density matrices.</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.add_spinned_core_rdms">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">add_spinned_core_rdms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mf</span></em>, <em class="sig-param"><span class="n">ncore</span></em>, <em class="sig-param"><span class="n">dm1a_act</span></em>, <em class="sig-param"><span class="n">dm1b_act</span></em>, <em class="sig-param"><span class="n">dm2aa_act</span></em>, <em class="sig-param"><span class="n">dm2ab_act</span></em>, <em class="sig-param"><span class="n">dm2bb_act</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#add_spinned_core_rdms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.add_spinned_core_rdms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an RHF core to the rdms in the MO basis to the 1 and 2 RDMs</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.calc_dipole">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">calc_dipole</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">mo_coeff</span></em>, <em class="sig-param"><span class="n">one_pdm</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#calc_dipole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.calc_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and return the dipole moment for a given molecule, set of
molecular orbital coefficients and a 1-rdm.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></span></dt><dd><p>Specifies the molecule.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Orbital coefficients. Each column is one orbital.</p>
</dd>
<dt>one_pdm<span class="classifier">ndarray</span></dt><dd><p>1-rdm.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tot_dipmom<span class="classifier">list of float</span></dt><dd><p>The total dipole moment of the system in each dimension.</p>
</dd>
<dt>elec_dipmom<span class="classifier">list of float</span></dt><dd><p>The electronic component of the dipole moment in each dimension.</p>
</dd>
<dt>nuc_dipmom<span class="classifier">list of float</span></dt><dd><p>The nuclear component of the dipole moment in each dimension.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.calc_energy_from_rdms">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">calc_energy_from_rdms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">mo_coeff</span></em>, <em class="sig-param"><span class="n">one_rdm</span></em>, <em class="sig-param"><span class="n">two_rdm</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#calc_energy_from_rdms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.calc_energy_from_rdms" title="Permalink to this definition">¶</a></dt>
<dd><p>From the full density matrices, calculate the energy.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier">An instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></span></dt><dd><p>The molecule to calculate</p>
</dd>
<dt>mo_coeff: ndarray</dt><dd><p>The MO orbitals in which the RDMs are calculated</p>
</dd>
<dt>one_rdm: ndarray</dt><dd><p>The 1RDM</p>
</dd>
<dt>two_rdm: ndarray</dt><dd><p>The 2RDM as RDM_ijkl = &lt; a^+_is a^+_kt a_lt a_js &gt;.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.execute_fciqmc">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">execute_fciqmc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#execute_fciqmc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.execute_fciqmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the external FCIQMC program.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>fciqmcci<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCIQMCCI</span></code></span></dt><dd><p>Specifies the FCIQMC calculation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.find_full_casscf_12rdm">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">find_full_casscf_12rdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">mo_coeff</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">norbcas</span></em>, <em class="sig-param"><span class="n">neleccas</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#find_full_casscf_12rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.find_full_casscf_12rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 1 and 2 full RDMs after a CASSCF calculation, by adding
on the contributions from the inactive spaces. Requires the cas space to
be given, as we as a set of mo coefficients in the complete space.</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.one_from_two_pdm">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">one_from_two_pdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">two_pdm</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#one_from_two_pdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.one_from_two_pdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-rdm, given a 2-rdm to contract.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>two_pdm<span class="classifier">ndarray</span></dt><dd><p>A (spin-free) 2-particle reduced density matrix.</p>
</dd>
<dt>nelec: int</dt><dd><p>The number of electrons contributing to the RDMs.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>one_pdm<span class="classifier">ndarray</span></dt><dd><p>The (spin-free) 1-particle reduced density matrix.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.read_energy">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">read_energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#read_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.read_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and return the final RDM energy from a NECI output file.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>fciqmcci<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCIQMCCI</span></code></span></dt><dd><p>Specifies the FCIQMC calculation. Used to locate the FCIQMC output
file.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rdm_energy<span class="classifier">float</span></dt><dd><p>The final RDM energy printed to the output file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.read_neci_1dms">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">read_neci_1dms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'OneRDM.1'</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#read_neci_1dms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.read_neci_1dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Read spinned rdms, as they are in the neci output</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.read_neci_2dms">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">read_neci_2dms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">filename_aa</span><span class="o">=</span><span class="default_value">'TwoRDM_aaaa.1'</span></em>, <em class="sig-param"><span class="n">filename_abba</span><span class="o">=</span><span class="default_value">'TwoRDM_abba.1'</span></em>, <em class="sig-param"><span class="n">filename_abab</span><span class="o">=</span><span class="default_value">'TwoRDM_abab.1'</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dm1a</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dm1b</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#read_neci_2dms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.read_neci_2dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Find spinned RDMs (assuming a/b symmetry). Return in pyscf form that
you would get from the e.g. direct_spin1.make_rdm12s routine, with Reorder=True.</p>
<p>This means (assuming reorder = True):
dm2ab[i,j,k,l] = &lt; i_a* k_b* l_b j_a &gt;
dm2aa[i,j,k,l] = &lt; i_a* k_a* l_a j_a &gt;</p>
<p>to get the dm2abba matrix (see spin_op.make_rdm2_abba) from this (assuming rhf), then you need
dm2abba = -dm2ab.transpose(2,1,0,3)</p>
<p>if reorder = False:</p>
<blockquote>
<div><p>dm2aa[:,k,k,:] += dm1a
dm2bb[:,k,k,:] += dm1b
dm2ab unchanged</p>
</div></blockquote>
<p>Note that the spin-free RDMs are just dm2aa + dm2bb + 2*dm2ab if reorder = True</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.read_neci_one_pdm">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">read_neci_one_pdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#read_neci_one_pdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.read_neci_one_pdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the spin-free 1RDM from neci by reading in the spin free 2RDM.
If core orbitals have been indicated as frozen in neci, this core contribution
will be explicitly added back in to the RDM. Therefore, the norb parameter
should be the total number of orbitals passed to neci (inc. frozen), while
nelec is the total number of electrons (inc. frozen), but not inactive if running
through CASSCF.</p>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.read_neci_two_pdm">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">read_neci_two_pdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#read_neci_two_pdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.read_neci_two_pdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a spin-free 2-rdm output from a NECI calculation, and return it in
a form supported by pyscf. Note that the RDMs in neci are written in
as RDM_ijkl = &lt; a^+_is a^+_jt a_lt a_ks &gt;. In pyscf, the correlated _after
<a href="#id1"><span class="problematic" id="id2">reordering_</span></a> is 2RDM_ijkl = &lt; a^+_is a^+_kt a_lt a_js &gt;, where s and t are spin
indices to be summed over. Therefore, the middle two indices need to be swapped.
If core orbitals have been indicated as frozen in neci, this core contribution
will be explicitly added back in to the RDM. Therefore, the norb parameter
should be the unfrozen number of orbitals passed to neci, but not inactive
if running through CASSCF.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>Name of the file to read the 2-rdm from.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>The number of orbitals inc. frozen in neci, and therefore the
number of values each 2-rdm index can take.</p>
</dd>
<dt>directory<span class="classifier">str</span></dt><dd><p>The directory in which to search for the 2-rdm file.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>two_pdm<span class="classifier">ndarray</span></dt><dd><p>The read-in 2-rdm.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.run_standalone">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">run_standalone</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">scf_obj</span></em>, <em class="sig-param"><span class="n">orbs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">restart</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#run_standalone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.run_standalone" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a standalone NECI calculation for the molecule listed in the
FCIQMCCI object. The basis to run this calculation in is given by the
orbs array.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>fciqmcci<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCIQMCCI</span></code></span></dt><dd><p>FCIQMC calculation containing parameters of NECI calculation to
run.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Orbital coefficients. Each column is one orbital.</p>
</dd>
<dt>restart<span class="classifier">bool</span></dt><dd><p>Is this a restarted NECI calculation?</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rdm_energy<span class="classifier">float</span></dt><dd><p>Final RDM energy obtained from the NECI output file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.write_fciqmc_config_file">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">write_fciqmc_config_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">neleca</span></em>, <em class="sig-param"><span class="n">nelecb</span></em>, <em class="sig-param"><span class="n">restart</span></em>, <em class="sig-param"><span class="n">tUHF</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#write_fciqmc_config_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.write_fciqmc_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an input file for a NECI calculation.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>fciqmcci<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCIQMCCI</span></code></span></dt><dd><p>Contains all the parameters used to create the input file.</p>
</dd>
<dt>neleca<span class="classifier">int</span></dt><dd><p>The number of alpha electrons.</p>
</dd>
<dt>nelecb<span class="classifier">int</span></dt><dd><p>The number of beta electrons.</p>
</dd>
<dt>restart<span class="classifier">bool</span></dt><dd><p>Is this a restarted NECI calculation?</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.write_integrals_file">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">write_integrals_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">neleca</span></em>, <em class="sig-param"><span class="n">nelecb</span></em>, <em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#write_integrals_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.write_integrals_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an integral dump file, based on the integrals provided.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core Hamiltonian.</p>
</dd>
<dt>eri<span class="classifier">2D ndarray</span></dt><dd><p>Two-electron integrals.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>neleca<span class="classifier">int</span></dt><dd><p>Number of alpha electrons.</p>
</dd>
<dt>nelecb<span class="classifier">int</span></dt><dd><p>Number of beta electrons</p>
</dd>
<dt>fciqmcci<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCIQMCCI</span></code></span></dt><dd><p>FCIQMC calculation, used to access the integral dump file name and
some symmetry properties.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.fciqmcscf.fciqmc.write_uhf_integrals_neci">
<code class="sig-prename descclassname">pyscf.fciqmcscf.fciqmc.</code><code class="sig-name descname">write_uhf_integrals_neci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciqmcci</span></em>, <em class="sig-param"><span class="n">scf_obj</span></em>, <em class="sig-param"><span class="n">nmo</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbs</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-15</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fciqmcscf/fciqmc.html#write_uhf_integrals_neci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fciqmcscf.fciqmc.write_uhf_integrals_neci" title="Permalink to this definition">¶</a></dt>
<dd><p>nmo is number of MO orbitals per spin channel
note that ordering is abababa…</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cornell_shci.html" class="btn btn-neutral float-right" title="cornell_shci — Semistochastic heat-bath configuration interaction (SHCI)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dmrgscf.html" class="btn btn-neutral float-left" title="dmrgscf — DMRG and DMRG-SCF/CASSCF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2021, The PySCF Developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>